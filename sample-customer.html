<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chainguard Vulnerability Report</title>
    <style>
/* PDF-optimized styles with Chainguard branding */
@page {
    margin: 0.75in;
    size: A4;
}

@page appendix {
    margin: 0.75in 0.75in 0.75in 0.75in;
    size: A4;
    @top-center {
        content: "Appendix";
        font-size: 16px;
        font-weight: 600;
        color: #14003d;
        border-bottom: 2px solid #7545fb;
        padding-bottom: 8px;
        margin-bottom: 20px;
    }
}

@media print {
    body { -webkit-print-color-adjust: exact; color-adjust: exact; }
    .navbar { display: none; }
    .container { padding-top: 0; }
    
    /* Enhanced table page breaking for new structure */
    .image-table-container {
        page-break-inside: avoid;
        break-inside: avoid;
        box-shadow: 0 4px 8px rgba(20, 0, 61, 0.15);
    }
    
    .image-table-container table {
        page-break-inside: auto;
        border: 2px solid var(--cg-primary);
    }
    
    .image-table-container thead {
        display: table-header-group;
        page-break-after: avoid;
    }
    
    .image-table-container thead th {
        border-bottom: 3px solid var(--cg-primary);
    }
    
    .image-comparison-row {
        page-break-inside: avoid;
        break-inside: avoid;
        page-break-after: auto;
    }
    
    .image-table-container tbody td {
        page-break-inside: avoid;
        break-inside: avoid;
    }
    
    /* Enhanced badge visibility in PDF */
    .vuln-badge {
        border: none;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        -webkit-print-color-adjust: exact;
        color-adjust: exact;
    }
    
    
    /* Prevent orphaned text */
    p, li {
        orphans: 3;
        widows: 3;
    }
    
    /* Improve severity table for PDF */
    .summary-table {
        page-break-inside: avoid;
    }
    
    .severity-count {
        font-size: 12px;
        font-weight: 700;
    }
    
    .severity-indicator {
        width: 10px;
        height: 10px;
    }
}

/* Chainguard Brand Colors */
:root {
    --cg-primary: #14003d;        /* Deep purple - primary text/backgrounds */
    --cg-secondary: #3443f4;      /* Bright blue - secondary elements */
    --cg-accent: #7545fb;         /* Purple accent - highlights */
    --cg-success: #7af0fe;        /* Light cyan - success/positive */
    --cg-light: #d0cfee;          /* Light purple - subtle backgrounds */
    --cg-white: #ffffff;
    --cg-black: #000000;
    --cg-gray-light: #f8f9fc;
    --cg-gray-medium: #e5e7f0;
    --cg-gray-dark: #6b7280;
}

/* Base styles */
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    background-color: var(--cg-white);
    color: var(--cg-primary);
    margin: 0;
    padding: 24px;
    line-height: 1.6;
    font-size: 13px;
    font-weight: 400;
}

.container {
    max-width: 100%;
    margin: 0;
    padding: 0;
}

/* Typography */
h1 {
    color: var(--cg-white);
    font-size: 28px;
    font-weight: 700;
    margin: 0 0 8px 0;
    text-align: center;
    letter-spacing: -0.025em;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

h2 {
    color: var(--cg-primary);
    font-size: 20px;
    font-weight: 600;
    margin: 32px 0 20px 0;
    text-align: left;
    border-bottom: 3px solid var(--cg-accent);
    padding-bottom: 8px;
    letter-spacing: -0.015em;
}

h3 {
    color: var(--cg-primary);
    font-size: 16px;
    font-weight: 600;
    margin: 24px 0 12px 0;
    border-bottom: 1px solid var(--cg-light);
    padding-bottom: 6px;
}

p {
    margin: 12px 0;
    line-height: 1.7;
    color: var(--cg-primary);
}

/* Code styling */
code {
    background-color: var(--cg-gray-light);
    color: var(--cg-secondary);
    padding: 3px 6px;
    border: 1px solid var(--cg-light);
    border-radius: 4px;
    font-family: "SF Mono", "Monaco", "Inconsolata", "Roboto Mono", "Courier New", monospace;
    font-size: 12px;
    font-weight: 500;
}

/* Layout sections */
.header-section {
    text-align: center;
    margin-bottom: 0;
    border-bottom: 4px solid var(--cg-accent);
    padding: 20px 32px 20px 32px;
    background: #14003d;
    border-radius: 12px;
    box-shadow: 0 8px 16px -2px rgba(20, 0, 61, 0.15);
    position: relative;
    color: var(--cg-white);
}

.header-logo {
    position: absolute;
    top: 20px;
    left: 20px;
    width: 60px;
    height: auto;
    max-height: 45px;
}

.header-section p {
    font-size: 14px;
    color: var(--cg-light);
    margin-top: 8px;
    font-weight: 400;
    opacity: 0.95;
}

.overview-grid {
    display: table;
    width: 100%;
    margin-bottom: 40px;
    border-spacing: 20px;
    table-layout: fixed;
}

.summary-column {
    display: table-cell;
    width: 50%;
    vertical-align: top;
    padding: 0;
}

.summary-column-content {
    background: var(--cg-white);
    border: 2px solid var(--cg-light);
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 4px 6px -1px rgba(20, 0, 61, 0.08);
    min-height: 400px;
}

.summary-column h2 {
    text-align: center;
    font-size: 18px;
    margin-bottom: 24px;
    color: var(--cg-primary);
}

/* Total boxes with enhanced Chainguard styling */
.total-box {
    padding: 24px;
    border: 2px solid var(--cg-light);
    text-align: center;
    font-size: 36px;
    font-weight: 700;
    margin-bottom: 24px;
    background: var(--cg-white);
    border-radius: 8px;
    box-shadow: 0 4px 6px -1px rgba(20, 0, 61, 0.08);
    flex-shrink: 0;
}

.total-box span {
    display: block;
    font-size: 13px;
    font-weight: 500;
    margin-top: 8px;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.customer-total {
    background: linear-gradient(135deg, #f8f9fc 0%, #e5e7f0 100%);
    border-color: #d0cfee;
    color: #14003d;
}

.chainguard-total {
    background: linear-gradient(135deg, #7af0fe 0%, #a7f3d0 100%);
    border-color: #7af0fe;
    color: var(--cg-primary);
}

.reduction-box {
    background: linear-gradient(135deg, var(--cg-success) 0%, #a7f3d0 100%);
    border-color: #7af0fe;
    color: var(--cg-primary);
    font-size: 40px;
}

/* Summary table styling */
.summary-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    border-radius: 6px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(20, 0, 61, 0.08);
}

.summary-table th,
.summary-table td {
    padding: 8px 12px;
    text-align: left;
    border-bottom: 1px solid var(--cg-light);
    font-size: 13px;
}

.summary-table th {
    background: var(--cg-primary);
    color: var(--cg-white);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    font-size: 11px;
}

.summary-table tbody tr:nth-child(even) {
    background-color: var(--cg-gray-light);
}

.severity-count {
    font-weight: 700;
    font-size: 14px;
    color: var(--cg-primary);
}

.severity-indicator {
    display: inline-block;
    width: 12px;
    height: 12px;
    border-radius: 2px;
    margin-right: 8px;
    vertical-align: middle;
}

/* Severity indicator colors - updated to match light background theme */
.severity-indicator.critical { 
    background: #f2e4f8;
    border: 1px solid #c08ad5;
}
.severity-indicator.high { 
    background: #fbe7e8;
    border: 1px solid #ee7f78;
}
.severity-indicator.medium { 
    background: #fcebcc;
    border: 1px solid #f3ad56;
}
.severity-indicator.low { 
    background: #fefad3;
    border: 1px solid #f7d959;
}
.severity-indicator.negligible { 
    background: #e8ecef;
    border: 1px solid #b8c2ca;
}
.severity-indicator.unknown { 
    background: #fafbfb;
    border: 1px solid #8b8d8f;
}

/* Enhanced sections */
.image-comparison-section {
    margin-top: 40px;
    margin-bottom: 40px;
    padding: 20px;
    border: 2px solid var(--cg-light);
    background: var(--cg-white);
    border-radius: 12px;
    box-shadow: 0 4px 6px -1px rgba(20, 0, 61, 0.08);
    page-break-inside: avoid;
    page-break-before: avoid;
}

.image-comparison-section h2 {
    margin-top: 0;
    color: var(--cg-primary);
    page-break-after: avoid;
    break-after: avoid;
}

/* Force Images Scanned section to start on new page */
.images-scanned-section {
    page-break-before: always !important;
    break-before: always !important;
}

/* Container to keep header and legend together */
.images-header-container {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    page-break-after: avoid !important;
    break-after: avoid !important;
}

/* Ensure Images Scanned header and color key stay together */
.image-comparison-section h2 + .color-key-legend {
    page-break-before: avoid;
    break-before: avoid;
}

/* Make first section directly adjacent to header */
.header-section + .image-comparison-section {
    margin-top: 0 !important;
    page-break-before: avoid !important;
    break-before: avoid !important;
}


/* CVE Reduction Analysis */
.overview-grid .summary-column h3 {
    text-align: center;
    margin-bottom: 24px;
    font-size: 16px;
    color: var(--cg-primary);
}

.reduction-stats {
    display: table;
    width: 100%;
    margin: 24px 0;
    border-spacing: 8px;
    height: 120px;
}

.reduction-stat {
    display: table-cell;
    text-align: center;
    padding: 24px 16px;
    background: var(--cg-gray-light);
    border: 2px solid var(--cg-light);
    border-radius: 8px;
    width: 50%;
    vertical-align: middle;
    height: 120px;
    box-shadow: 0 4px 6px -1px rgba(20, 0, 61, 0.08);
}

.single-reduction-stat {
    text-align: center;
    padding: 24px;
    background: var(--cg-gray-light);
    border: 2px solid var(--cg-light);
    border-radius: 8px;
    margin-bottom: 24px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    box-shadow: 0 4px 6px -1px rgba(20, 0, 61, 0.08);
    flex-shrink: 0;
}

.reduction-stat-value {
    font-size: 40px;
    font-weight: 700;
    color: var(--cg-primary);
    display: block;
    margin-bottom: 8px;
    line-height: 1;
}

.reduction-stat-label {
    font-size: 13px;
    color: var(--cg-gray-dark);
    display: block;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    font-weight: 500;
}

/* Enhanced Professional table styling */
.image-table-container {
    width: 100%;
    overflow: visible;
    margin: 30px 0;
    page-break-inside: avoid;
    break-inside: avoid;
    border-radius: 12px;
    box-shadow: 0 8px 16px -4px rgba(20, 0, 61, 0.12);
    background: var(--cg-white);
}

.image-table-container table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    border-radius: 12px;
    overflow: hidden;
    table-layout: fixed;
    page-break-inside: auto;
    border: 2px solid var(--cg-light);
}

.image-table-container th,
.image-table-container td {
    padding: 16px 12px;
    border-bottom: 1px solid var(--cg-gray-medium);
    text-align: left;
    font-size: 12px;
    vertical-align: middle;
    word-wrap: break-word;
    overflow-wrap: break-word;
    page-break-inside: avoid;
    break-inside: avoid;
    line-height: 1.5;
}

.image-table-container thead th {
    background: var(--cg-primary);
    color: var(--cg-white);
    font-weight: 600;
    font-size: 14px;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    page-break-after: avoid;
    border-bottom: 3px solid var(--cg-accent);
}

.image-table-container tbody tr {
    page-break-inside: avoid;
    break-inside: avoid;
    page-break-after: auto;
    transition: background-color 0.2s ease;
}

.image-table-container tbody tr:nth-child(even) {
    background-color: var(--cg-gray-light);
}

.image-table-container tbody tr:nth-child(odd) {
    background-color: var(--cg-white);
}

.image-table-container tbody tr:hover {
    background-color: rgba(116, 69, 251, 0.08);
}

/* Simplified table cell styling */
.image-name {
    font-family: "SF Mono", "Monaco", "Inconsolata", "Roboto Mono", "Courier New", monospace;
    font-size: 11px;
    font-weight: 600;
    color: var(--cg-primary);
    background: rgba(255, 255, 255, 0.8);
    padding: 4px 8px;
    border-radius: 6px;
    border: 1px solid var(--cg-light);
}

.image-name-cell {
    width: 40%;
}

.breakdown-cell {
    width: 10%;
}

.vulnerability-count {
    font-weight: 700;
    font-size: 14px;
    color: var(--cg-primary);
    text-align: center;
}

.no-match {
    color: var(--cg-gray-dark);
    font-style: italic;
    font-weight: 500;
}

/* Enhanced vulnerability breakdown styling */
.vuln-breakdown-container {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    justify-content: center;
    align-items: center;
    padding: 2px;
}

.vuln-badge {
    display: inline-flex;
    align-items: center;
    gap: 2px;
    padding: 3px 6px;
    border-radius: 12px;
    font-size: 10px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border: none;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.vuln-code {
    font-weight: 700;
    opacity: 0.9;
}

.vuln-count {
    font-weight: 800;
    font-size: 11px;
}

/* Severity-specific badge colors - updated to match light background theme */
.vuln-critical {
    background-color: #f2e4f8;
    color: #82349d;
    border: 1px solid #c08ad5;
}

.vuln-high {
    background-color: #fbe7e8;
    color: #98362e;
    border: 1px solid #ee7f78;
}

.vuln-medium {
    background-color: #fcebcc;
    color: #a1531e;
    border: 1px solid #f3ad56;
}

.vuln-low {
    background-color: #fefad3;
    color: #76651d;
    border: 1px solid #f7d959;
}

.vuln-negligible {
    background-color: #e8ecef;
    color: #4d5b6a;
    border: 1px solid #b8c2ca;
}

.vuln-unknown {
    background-color: #fafbfb;
    color: #4d5b6a;
    border: 1px solid #8b8d8f;
}

.vuln-clean {
    background-color: var(--cg-success);
    color: var(--cg-primary);
    border: none;
    font-weight: 700;
}

.breakdown-error {
    color: var(--cg-gray-dark);
    font-style: italic;
    font-weight: 500;
}

/* Enhanced table legend styling */
.table-legend {
    margin: 20px 0;
    padding: 20px;
    background: linear-gradient(135deg, rgba(208, 207, 238, 0.2) 0%, rgba(229, 231, 240, 0.2) 100%);
    border-radius: 12px;
    border: 2px solid var(--cg-light);
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.legend-section {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.legend-title {
    font-size: 14px;
    font-weight: 700;
    color: var(--cg-primary);
    margin: 0;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.legend-note {
    margin: 0;
    font-size: 12px;
    color: var(--cg-gray-dark);
    display: flex;
    align-items: center;
    gap: 8px;
}

.legend-icon {
    background: var(--cg-accent);
    color: white;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 700;
}

.legend-badges, .legend-indicators {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    align-items: center;
    margin-top: 8px;
}

.legend-badge {
    transform: scale(0.9);
}

.legend-text {
    font-size: 12px;
    color: var(--cg-primary);
    font-weight: 500;
    margin-right: 16px;
}

/* Print optimization for legend */
@media print {
    .table-legend {
        page-break-inside: avoid;
        break-inside: avoid;
        border: 2px solid var(--cg-primary);
        box-shadow: 0 2px 4px rgba(20, 0, 61, 0.1);
    }
    
    .legend-badges, .legend-indicators {
        gap: 8px;
    }
    
    .legend-text {
        margin-right: 12px;
    }
}

/* Enhanced Appendix with better page break handling */
.appendix-content {
    text-align: left;
    padding: 24px;
    background: var(--cg-gray-light);
    border-radius: 8px;
    border: 2px solid var(--cg-light);
    page-break-before: always;
}

.appendix-content h2 {
    page-break-after: avoid;
    margin-top: 0 !important;
    margin-bottom: 20px;
}

.appendix-content h3 {
    font-size: 16px;
    margin-top: 28px;
    color: var(--cg-primary);
    border-bottom-color: var(--cg-accent);
    page-break-after: avoid;
    page-break-before: auto;
}

.appendix-content ul {
    margin: 16px 0;
    padding-left: 24px;
    page-break-inside: auto;
}

.appendix-content li {
    margin-bottom: 8px;
    line-height: 1.6;
    font-size: 12px;
    color: var(--cg-primary);
    page-break-inside: avoid;
}

.appendix-content p {
    orphans: 2;
    widows: 2;
    page-break-inside: auto;
}

.appendix-content strong {
    color: var(--cg-accent);
    font-weight: 600;
}

/* Appendix section grouping for better page breaks */
.appendix-section {
    page-break-inside: avoid;
    margin-bottom: 32px;
}

.appendix-section:last-child {
    margin-bottom: 0;
}

@media print {
    .appendix-content {
        page-break-before: always;
        break-before: always;
        background: transparent;
        border: none;
        border-radius: 0;
        box-shadow: none;
        page: appendix;
        page-break-inside: auto;
        break-inside: auto;
    }
    
    .appendix-content h3 {
        page-break-after: avoid;
        break-after: avoid;
        page-break-before: auto;
        break-before: auto;
    }
    
    .appendix-content ul {
        page-break-inside: auto;
        break-inside: auto;
    }
    
    .appendix-content li {
        page-break-inside: avoid;
        break-inside: avoid;
        orphans: 2;
        widows: 2;
    }
    
    .appendix-content p {
        orphans: 2;
        widows: 2;
        page-break-inside: auto;
        break-inside: auto;
    }
    
    .appendix-section {
        page-break-inside: avoid;
        break-inside: avoid;
    }
    
    /* Strategic page break with continuation header */
    .appendix-page-break {
        page-break-before: always;
        break-before: always;
        margin-top: 0;
        padding-top: 0;
    }
    
    .appendix-continuation {
        color: var(--cg-primary);
        font-size: 20px;
        font-weight: 600;
        margin: 0 0 20px 0 !important;
        text-align: left;
        border-bottom: 3px solid var(--cg-accent);
        padding-bottom: 8px;
        letter-spacing: -0.015em;
        page-break-after: avoid;
    }
    
    /* Chrome PDF export specific footer behavior - now inside appendix */
    .appendix-content .footer {
        page-break-before: avoid;
        break-before: avoid;
        page-break-inside: avoid;
        break-inside: avoid;
        margin-top: 30px;
        border-radius: 8px;
        background: var(--cg-white);
        border: 2px solid var(--cg-light);
    }
}

/* Professional Footer */
.footer {
    text-align: center;
    margin-top: 40px;
    padding: 20px;
    font-size: 11px;
    color: var(--cg-gray-dark);
    border-top: 2px solid var(--cg-light);
    background: var(--cg-gray-light);
    border-radius: 0 0 8px 8px;
    font-weight: 500;
    page-break-before: avoid;
    page-break-inside: avoid;
}

/* Navbar - hidden in print */
.navbar {
    display: none;
}

/* Utility classes */
.no-break {
    page-break-inside: avoid;
}

/* Additional professional touches */
strong {
    color: var(--cg-primary);
    font-weight: 600;
}

em {
    color: var(--cg-accent);
    font-style: normal;
    font-weight: 500;
}

/* Small caps for labels */
.label {
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    font-weight: 500;
    color: var(--cg-gray-dark);
}

/* Vulnerability square boxes styling */
.vuln-squares-container {
    display: flex;
    flex-wrap: wrap;
    gap: 2px;
    justify-content: flex-start;
    align-items: center;
    padding: 4px;
    min-height: 24px;
}

.vuln-square {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 26px;
    height: 26px;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 800;
    text-shadow: none;
    border: 1px solid;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    margin: 1px;
    min-width: 26px;
    text-align: center;
    line-height: 1;
}

/* Severity-specific square colors with light backgrounds and dark text */
.vuln-square.vuln-critical {
    background-color: #f2e4f8;
    color: #82349d;
    border-color: #c08ad5;
}

.vuln-square.vuln-high {
    background-color: #fbe7e8;
    color: #98362e;
    border-color: #ee7f78;
}

.vuln-square.vuln-medium {
    background-color: #fcebcc;
    color: #a1531e;
    border-color: #f3ad56;
}

.vuln-square.vuln-low {
    background-color: #fefad3;
    color: #76651d;
    border-color: #f7d959;
}

.vuln-square.vuln-negligible {
    background-color: #e8ecef;
    color: #4d5b6a;
    border-color: #b8c2ca;
}

.vuln-square.vuln-unknown {
    background-color: #fafbfb;
    color: #4d5b6a;
    border-color: #8b8d8f;
}

.vuln-square.vuln-clean {
    background-color: var(--cg-success);
    color: var(--cg-primary);
    border-color: var(--cg-success);
    width: 28px;
    font-weight: 800;
}

/* Responsive sizing for smaller counts */
.vuln-square[data-count="1"], .vuln-square[data-count="2"], .vuln-square[data-count="3"] {
    width: 22px;
    height: 22px;
    font-size: 10px;
    min-width: 22px;
}

/* Color Key Legend Styling - Compact horizontal layout */
.color-key-legend {
    margin: 15px 0 20px 0;
    padding: 16px 20px;
    background: linear-gradient(135deg, rgba(208, 207, 238, 0.08) 0%, rgba(229, 231, 240, 0.08) 100%);
    border: 1px solid var(--cg-light);
    border-radius: 8px;
    page-break-inside: avoid;
    break-inside: avoid;
    page-break-after: avoid;
    break-after: avoid;
}

.legend-content {
    display: flex;
    align-items: center;
    gap: 20px;
    flex-wrap: wrap;
}

.color-key-legend .legend-title {
    font-size: 14px;
    font-weight: 600;
    color: var(--cg-primary);
    margin: 0;
    white-space: nowrap;
    flex-shrink: 0;
}

.legend-squares {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    align-items: center;
    flex: 1;
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
}

.legend-square {
    width: 22px !important;
    height: 22px !important;
    font-size: 11px !important;
    font-weight: 800 !important;
    flex-shrink: 0;
}

.legend-label {
    font-size: 11px;
    font-weight: 500;
    color: var(--cg-primary);
    white-space: nowrap;
}

.legend-description {
    font-size: 11px;
    color: var(--cg-gray-dark);
    margin: 8px 0 0 0;
    line-height: 1.4;
    font-style: italic;
}

/* PDF print optimizations for squares */
@media print {
    /* Force Images Scanned to start on new page */
    .images-scanned-section {
        page-break-before: always !important;
        break-before: always !important;
    }
    
    /* Prevent breaking of header and legend container */
    .images-header-container {
        page-break-inside: avoid !important;
        break-inside: avoid !important;
        page-break-after: avoid !important;
        break-after: avoid !important;
    }
    
    .color-key-legend {
        page-break-inside: avoid !important;
        break-inside: avoid !important;
        page-break-before: avoid !important;
        break-before: avoid !important;
        page-break-after: avoid !important;
        break-after: avoid !important;
    }
    
    .vuln-squares-container {
        gap: 1px;
        padding: 2px;
    }
    
    .vuln-square {
        -webkit-print-color-adjust: exact;
        color-adjust: exact;
        border: none;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        page-break-inside: avoid;
        break-inside: avoid;
    }
    
    .vuln-square {
        border: 1px solid rgba(0, 0, 0, 0.1) !important;
    }
    
    .vuln-square.vuln-low {
        color: black !important;
        text-shadow: none !important;
    }
    
    .vuln-square.vuln-clean {
        color: var(--cg-primary) !important;
        text-shadow: none !important;
    }
    
    .color-key-legend {
        page-break-inside: avoid;
        break-inside: avoid;
        border: 1px solid var(--cg-primary);
        background: rgba(248, 249, 252, 0.5);
        margin: 10px 0 15px 0;
        padding: 12px 16px;
    }
    
    .legend-content {
        gap: 16px;
    }
    
    .legend-squares {
        gap: 12px;
    }
    
    .legend-item {
        gap: 4px;
    }
    
    .legend-description {
        margin: 6px 0 0 0;
    }
}
    </style>
</head>
<body>
    <div class="container">
        <div class="header-section">
            <img class="header-logo" src="Linky_White.png" alt="Chainguard Logo">
            <h1>Vulnerability Comparison Report</h1>
            <p>A comprehensive analysis comparing vulnerabilities in your container images versus Chainguard's hardened alternatives.</p>
        </div>

        <!-- Executive Summary -->
        <div class="image-comparison-section no-break">
            <h2>Executive Summary</h2>
            <p><h3>Security Vulnerability Assessment for Sample_Customer</h3></p><p>This comprehensive vulnerability assessment demonstrates the challenges that Sample_Customer face in managing CVE's at scale. Sample_Customer is not alone in this challenge as many in the industry are grappling with CVE spawl & controls around OSS. This report shows the significant security advantages of migrating from standard container images to <strong>Chainguard's hardened alternatives</strong>. Analysis of 3 container image pairs reveals a <strong>99.7% overall CVE reduction</strong>, eliminating 1056 vulnerabilities across your infrastructure.</p><p><h3>Key Findings</h3></p><ul><li><strong>Significant Vulnerability Reduction</strong>: 3 of 3 images show measurable improvement with Chainguard alternatives</li>
<li><strong>Average Per-Image Improvement</strong>: 98.4% average CVE reduction per improved image</li>
<li><strong>Total Impact</strong>: 1059 vulnerabilities in current images reduced to 3 with Chainguard</li>
<li><strong>Reduced Attack Surface</strong>: Distroless and minimal base images eliminate unnecessary components</li>
<li><strong>Faster Remediation</strong>: Streamlined images enable quicker security updates and patches</li></ul><p><h3>Business Impact</h3></p><p><strong>Overall Business Value</strong> A direct cost savings can be calculated as follows. 1-4hrs to resolve a CVE when you consider the research, business process/approvals and actual engineering effort. 
The equates to a cost of over <strong>$2.7m</strong> based on average wage/engineering effort metrics.</p><ul><li><strong>Enhanced Security Posture</strong>: 99.7% reduction translates to significantly lower risk of a breach</li>
<li><strong>Compliance Readiness</strong>: Fewer vulnerabilities mean easier security compliance achievement </li>
<li><strong>Operational Efficiency</strong>: 1056 fewer CVEs to track, patch, and manage</li>
<li><strong>Developer Productivity</strong>: Less time addressing security issues, more time on shipping value to the business</li></ul><p><h3>Recommendation</h3></p><p>With demonstrated <strong>99.7% CVE reduction</strong> across 3 analyzed images, we strongly recommend transitioning to Chainguard images as part of your DevSecOps strategy to mature security practices and reduce operational toil across platform, security, and development teams.
</p>
        </div>

        <!-- CVE Reduction Metrics -->
        <div class="image-comparison-section no-break">
            <h2>CVE Reduction Analysis</h2>
            <div style="text-align: center; margin-bottom: 30px;">
                <div class="total-box reduction-box" style="display: block; margin: 0 auto 20px auto; width: 300px;">
                    99.7%
                    <span>CVE Reduction</span>
                </div>
                <p style="text-align: center; margin: 0; font-size: 16px; color: var(--cg-primary);"><strong>1056</strong> fewer vulnerabilities with Chainguard images</p>
            </div>
            
            <!-- Overview Section within CVE Reduction Analysis -->
            <div class="overview-grid" style="margin-top: 40px;">
                <!-- Customer Images Column -->
                <div class="summary-column">
                    <div class="summary-column-content">
                        <h2>Your Images</h2>
                        <div class="total-box customer-total">
                            1059
                            <span>Total Vulnerabilities</span>
                        </div>
                        <table class="summary-table">
                            <thead>
                                <tr>
                                    <th>Severity</th>
                                    <th>Count</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><span class="severity-indicator critical"></span>Critical</td>
                                    <td class="severity-count">15</td>
                                </tr>
                                <tr>
                                    <td><span class="severity-indicator high"></span>High</td>
                                    <td class="severity-count">96</td>
                                </tr>
                                <tr>
                                    <td><span class="severity-indicator medium"></span>Medium</td>
                                    <td class="severity-count">161</td>
                                </tr>
                                <tr>
                                    <td><span class="severity-indicator low"></span>Low</td>
                                    <td class="severity-count">93</td>
                                </tr>
                                <tr>
                                    <td><span class="severity-indicator negligible"></span>Negligible</td>
                                    <td class="severity-count">694</td>
                                </tr>
                                <tr>
                                    <td><span class="severity-indicator unknown"></span>Unknown</td>
                                    <td class="severity-count">0</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Chainguard Images Column -->
                <div class="summary-column">
                    <div class="summary-column-content">
                        <h2>Chainguard Images</h2>
                        <div class="total-box chainguard-total">
                            3
                            <span>Total Vulnerabilities</span>
                        </div>
                        <table class="summary-table">
                            <thead>
                                <tr>
                                    <th>Severity</th>
                                    <th>Count</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><span class="severity-indicator critical"></span>Critical</td>
                                    <td class="severity-count">0</td>
                                </tr>
                                <tr>
                                    <td><span class="severity-indicator high"></span>High</td>
                                    <td class="severity-count">1</td>
                                </tr>
                                <tr>
                                    <td><span class="severity-indicator medium"></span>Medium</td>
                                    <td class="severity-count">0</td>
                                </tr>
                                <tr>
                                    <td><span class="severity-indicator low"></span>Low</td>
                                    <td class="severity-count">2</td>
                                </tr>
                                <tr>
                                    <td><span class="severity-indicator negligible"></span>Negligible</td>
                                    <td class="severity-count">0</td>
                                </tr>
                                <tr>
                                    <td><span class="severity-indicator unknown"></span>Unknown</td>
                                    <td class="severity-count">0</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Image Comparison Table -->
        <div class="image-comparison-section images-scanned-section">
            <div class="images-header-container">
                <h2>Images Scanned</h2>
                
                <!-- Color Key Legend -->
                <div class="color-key-legend">
                <div class="legend-content">
                    <h3 class="legend-title">Vulnerability Severity Color Key:</h3>
                    <div class="legend-squares">
                        <div class="legend-item">
                            <span class="vuln-square vuln-critical legend-square">C</span>
                            <span class="legend-label">Critical</span>
                        </div>
                        <div class="legend-item">
                            <span class="vuln-square vuln-high legend-square">H</span>
                            <span class="legend-label">High</span>
                        </div>
                        <div class="legend-item">
                            <span class="vuln-square vuln-medium legend-square">M</span>
                            <span class="legend-label">Medium</span>
                        </div>
                        <div class="legend-item">
                            <span class="vuln-square vuln-low legend-square">L</span>
                            <span class="legend-label">Low</span>
                        </div>
                        <div class="legend-item">
                            <span class="vuln-square vuln-negligible legend-square">N</span>
                            <span class="legend-label">Negligible</span>
                        </div>
                        <div class="legend-item">
                            <span class="vuln-square vuln-unknown legend-square">U</span>
                            <span class="legend-label">Unknown</span>
                        </div>
                        <div class="legend-item">
                            <span class="vuln-square vuln-clean legend-square"></span>
                            <span class="legend-label">Clean</span>
                        </div>
                    </div>
                </div>
                <p class="legend-description">Each square shows the count of vulnerabilities for that severity level.</p>
                </div>
            </div>
            
            <div class="image-table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Your Image</th>
                            <th>Vulnerability Breakdown</th>
                            <th>Chainguard Image</th>
                            <th>Vulnerability Breakdown</th>
                        </tr>
                    </thead>
                    <tbody>
                        
                <tr class="image-comparison-row">
                    <td class="image-name-cell">
                        <code class="image-name">nginx:latest</code>
                    </td>
                    <td class="vulnerability-count"><div class="vuln-squares-container"><span class="vuln-square vuln-critical">3</span><span class="vuln-square vuln-high">17</span><span class="vuln-square vuln-medium">28</span><span class="vuln-square vuln-low">9</span><span class="vuln-square vuln-negligible">89</span></div></td>
                    <td class="image-name-cell">
                        <code class="image-name">cgr.dev/chainguard/nginx:latest</code>
                    </td>
                    <td class="vulnerability-count">
                        <div class="vuln-squares-container"><span class="vuln-square vuln-clean"></span></div>
                    </td>
                </tr>
            
                <tr class="image-comparison-row">
                    <td class="image-name-cell">
                        <code class="image-name">alpine/java:21</code>
                    </td>
                    <td class="vulnerability-count"><div class="vuln-squares-container"><span class="vuln-square vuln-critical">2</span><span class="vuln-square vuln-high">12</span><span class="vuln-square vuln-medium">20</span><span class="vuln-square vuln-low">9</span></div></td>
                    <td class="image-name-cell">
                        <code class="image-name">cgr.dev/chainguard/jdk:openjdk-21</code>
                    </td>
                    <td class="vulnerability-count">
                        <div class="vuln-squares-container"><span class="vuln-square vuln-low">2</span></div>
                    </td>
                </tr>
            
                <tr class="image-comparison-row">
                    <td class="image-name-cell">
                        <code class="image-name">python:latest</code>
                    </td>
                    <td class="vulnerability-count"><div class="vuln-squares-container"><span class="vuln-square vuln-critical">10</span><span class="vuln-square vuln-high">67</span><span class="vuln-square vuln-medium">113</span><span class="vuln-square vuln-low">75</span><span class="vuln-square vuln-negligible">605</span></div></td>
                    <td class="image-name-cell">
                        <code class="image-name">cgr.dev/chainguard/python:latest</code>
                    </td>
                    <td class="vulnerability-count">
                        <div class="vuln-squares-container"><span class="vuln-square vuln-high">1</span></div>
                    </td>
                </tr>
            
                    </tbody>
                </table>
            </div>
            <div class="table-legend">
                <div class="legend-section">
                    <p class="legend-note">
                        <span class="legend-icon">*</span>
                        Images marked with an asterisk were retried with the :latest tag after initial scan failure.
                    </p>
                </div>
            </div>
        </div>

        
        
        <!-- Appendix Section -->
        <div class="appendix-content">
            <h2>Appendix</h2>
            <div><p><h3>Sample_Customer Specific Logic/Assumptions</h3></p><p><ul><li>Sample_Customer provided <strong>1,710 images</strong></li>
<li>Mapped to Chainguard alternatives which <strong>matched 1,498</strong> images</li>
<li>If the upstream software was EOL we mapped to :latest in Chainguard image</li>
<li>Of the <strong>1498</strong> images we mapped 85 unique Chainguard images</li>
<li>Grype is leveraged as the scanner tool to scan both the Sample_Customer provided image as well as the Chainguard image</li>
<li>If a scan with grype failed on any image, it attempted a tag for re-scanning which is represented with a *</li>
<li>If the above logic fails, the entire row will fail and is not included in the report. This is to ensure 1:1 comparison. Eg: some Customer images are behind a paywall or simply not available in the public registry</li>
<li>CVE cost figure based on: Average 1hr to resolve a single CVE (including business process). An engineer wage of $75 per hour multiplied by # of CVE's</li></ul>
</p>
                <div class="appendix-section">
                    <h3>Methodology</h3>
                    <p>This report was generated using the following methodology:</p>
                    <ul>
                        <li><strong>Scanning Tool:</strong> Grype vulnerability scanner</li>
                        <li><strong>Data Sources:</strong> National Vulnerability Database (NVD) and other security databases</li>
                        <li><strong>Image Analysis:</strong> Container images were scanned for known vulnerabilities</li>
                        <li><strong>Comparison:</strong> Customer images compared against Chainguard hardened alternatives</li>
                    </ul>
                </div>
                
                <!-- Strategic page break marker with continuation header -->
                <div class="appendix-page-break">
                    <h2 class="appendix-continuation">Appendix (continued)</h2>
                </div>
                
                <div class="appendix-section">
                    <h3>Severity Levels</h3>
                    <p>Vulnerabilities are classified using the following severity levels:</p>
                    <ul>
                        <li><strong>Critical:</strong> Vulnerabilities with CVSS scores of 9.0-10.0</li>
                        <li><strong>High:</strong> Vulnerabilities with CVSS scores of 7.0-8.9</li>
                        <li><strong>Medium:</strong> Vulnerabilities with CVSS scores of 4.0-6.9</li>
                        <li><strong>Low:</strong> Vulnerabilities with CVSS scores of 0.1-3.9</li>
                        <li><strong>Negligible:</strong> Vulnerabilities with minimal impact</li>
                        <li><strong>Unknown:</strong> Vulnerabilities without assigned severity scores</li>
                    </ul>
                </div>
                
                <div class="appendix-section">
                    <h3>About Chainguard Images</h3>
                    <p>Chainguard Images are container images built with security-first principles:</p>
                    <ul>
                        <li><strong>Minimal Base:</strong> Built on minimal base images to reduce attack surface</li>
                        <li><strong>Distroless:</strong> Contains only application dependencies, no package managers</li>
                        <li><strong>Regular Updates:</strong> Continuously updated with latest security patches</li>
                        <li><strong>Zero CVEs:</strong> Many images maintain zero known vulnerabilities</li>
                        <li><strong>SBOM Included:</strong> Software Bill of Materials for transparency</li>
                        <li><strong>Provenance Tracking:</strong> Complete software supply chain transparency with cryptographic attestations and verifiable build processes</li>
                    </ul>
                </div></div>
            
            <!-- Footer integrated within appendix container -->
            <div class="footer">
<<<<<<< HEAD
                <p>This report is Sample_Customer & Chainguard Confidential | Generated on 2025-08-03 15:38:27</p>
=======
                <p>This report is Sample_Customer & Chainguard Confidential | Generated on 2025-08-03 11:28:02</p>
>>>>>>> parent of 2c177e7 (updated pdf and sample_appendix.md)
            </div>
        </div>
    </div>
</body>
</html>